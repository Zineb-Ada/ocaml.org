type tab = 
  | Overview
  | Documentation
  

let packages_link =
  <a class="text-lg text-orange-600 font-bold" href="<%s Url.packages %>">Packages</a>

let version_select ~tab ~(package : Package_intf.package) =
  <select id="version" name="version" onchange="location = this.value;" class="w-full lg:w-auto appearance-none text-body-600 border rounded-md py-1 pl-3 border-gray-200 pr-14 h-full">
    <% package.versions |> List.iter begin fun v -> %>
    <option value="<%s (match tab with
      | Documentation -> Url.package_doc package.name v ~page:"index.html"
      | Overview -> Url.package_with_version package.name v) %>" <%s if v = package.version then "selected" else "" %>>
      <%s v %>
    </option>
    <% end; %>
  </select>

let package_overview_link ~active ~(package : Package_intf.package) =
  <a class="font-semibold text-gray-900 <%s if active then "underline" else ""%>" href="<%s Url.package_with_version package.name package.version %>"><%s package.name %></a>

let package_docs_link ~active ~(package: Package_intf.package) =
  <a class="<%s if active then "text-gray-900 underline" else ""%>" href="<%s Url.package_doc package.name package.version ~page:"index.html" %>">Documentation</a>


let render
?styles
~title
~description
~(tab: tab)
~documentation_status
~canonical
~(package : Package_intf.package)
inner_html =
(*
let unavailable_tab_class = "border-transparent border-b-2 p-4 font-medium relative text-gray-400" in
let tab_class = "border-transparent border-b-2 hover:border-primary-600 p-4 font-medium relative text-body-400" in
let current_tab_class = "border-b-2 hover:border-primary-600 p-4 font-medium border-primary-600 relative text-primary-600" in
let documentation_dot = match documentation_status with 
  | `Failure -> "<span class=\"bg-red-500 ml-2 absolute top-2 p-1 rounded-full inline-block\"></span>"
  | `Success -> "<span class=\"bg-green-500 ml-2 absolute top-2 p-1 rounded-full inline-block\"></span>"
  | `Unknown -> "<span class=\"bg-orange-300 ml-2 absolute top-2 p-1 rounded-full inline-block\"></span>"
in
let doc_status_tooltip = match documentation_status with
  | `Failure -> "title=\"documentation failed to build\""
  | `Unknown -> "title=\"failed to fetch documentation\""
  | _ -> ""
in *)
let _doc_status_tooltip = match documentation_status with
  | `Failure -> "title=\"documentation failed to build\""
  | `Unknown -> "title=\"failed to fetch documentation\""
  | _ -> ""
in
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <% (match description with | Some description -> %>
    <meta name="description" content="<%s description %>">
    <% | None -> ()); %>
    <meta name="twitter:title" content="<%s title %>">
    <% (match description with | Some description -> %>
    <meta name="twitter:description" content="<%s description %>">
    <% | None -> ()); %>
    <meta property="og:site_name" content="OCaml">
    <meta property="og:type" content="object">
    <meta property="og:title" content="<%s title %>">
    <% (match description with | Some description -> %>
    <meta property="og:description" content="<%s description %>">
    <% | None -> ()); %>
    <% (match canonical with | Some canonical -> %>
    <link rel="canonical" href="https://ocaml.org<%s canonical %>">
    <% | None -> ()); %>
    <meta name="theme-color" content="#fff">
    <meta name="color-scheme" content="white">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <% (match styles with | Some styles -> styles |> List.iter (fun style -> %>
    <link rel="stylesheet" href="<%s style %>">
    <% ) | None -> %>
    <link rel="stylesheet" href="/css/main.css">
    <% ); %>
    <link rel="stylesheet" href="/vendors/font-files/inter.css">
    <script defer src="/vendors/alpine.min.js"></script>
    <title><%s title %></title>
  </head>

  <body class="light">
    <%s! Docs_header.render ~inner_html:((packages_link) ^ (package_overview_link ~package ~active:(tab == Overview)) ^ (version_select ~tab ~package) ^ (package_docs_link ~package ~active:(tab == Documentation))) %>

    <div class="pt-12">
      <%s! inner_html %>
    </div>

    <%s! Docs_footer.render () %>
  </body>
</html>
